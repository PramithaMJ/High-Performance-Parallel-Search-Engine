Source URL: https://medium.com/@lpramithamj/fixing-the-gpg-key-error-for-visual-studio-code-on-ubuntu-f29562a38182



# lFixing the GPG Key Error for Visual Studio Code on Ubuntu

Pramitha Jayasooriya4 min readÂ·Feb 23, 2025--1ListenShare

# GPG Keys Gone Missing? Time to Bribe the Linux Gatekeeper!

Generated by AIAfter installing Visual Studio Code (VS Code) on my Ubuntu machine, I encountered an error when trying to update my package manager using the sudo apt update command. The error message looked like this:Err:4 https://packages.microsoft.com/repos/code stable InRelease 

 The following signatures couldnt be verified because the public key is not available: NO_PUBKEY EB3E94ADBE1229CFAdditionally, I saw these warnings:W: GPG error: https://packages.microsoft.com/repos/code stable InRelease: The following signatures couldnt be verified because the public key is not available: NO_PUBKEY EB3E94ADBE1229CF

E: The repository https://packages.microsoft.com/repos/code stable InRelease is not signed.

N: Updating from such a repository cant be done securely, and is therefore disabled by default.

N: See apt-secure(8) manpage for repository creation and user configuration details.Despite this error, VS Code was running fine, but the error was annoying every time I updated my system. In this article, Iâ€™ll explain why this error occurs, what GPG keys are, and how to fix it properly.

# What is GPG?

GPG (GNU Privacy Guard) is an encryption system used to sign and verify software packages in Linux. When a software package is signed with a GPG key, it ensures that the package comes from a trusted source and hasnâ€™t been tampered with.In Ubuntu, APT (Advanced Package Tool) relies on GPG keys to verify package authenticity. If a repository does not have a valid GPG key, APT will reject it and show errors like the one I encountered.

# Why Does This Error Happen?

The error occurs because Ubuntuâ€™s package manager (APT) cannot verify the Microsoft repository due to a missing or outdated GPG key.Microsoftâ€™s repository for VS Code is located at:https://packages.microsoft.com/repos/codeHowever, the public key needed to verify this repository (EB3E94ADBE1229CF) is missing, leading to the error.This issue can happen due to:

Missing GPG key: The key was never added to the system.

Expired or outdated key: The key has changed, but the system is still using an old version.

Repository not correctly configured: The repository might be misconfigured, preventing the key from being used correctly.To fix this, we need to download and install the correct Microsoft GPG key and ensure the repository is correctly set up.

# How to Fix the GPG Key Error



# Step 1: Download and Install the Microsoft GPG Key

Run the following command to download and securely store the Microsoft GPG key:wget -qO - https://packages.microsoft.com/keys/microsoft.asc | sudo gpg --dearmor -o /usr/share/keyrings/microsoft.gpg

## What This Command Does:



wget -qO - https://packages.microsoft.com/keys/microsoft.asc â†’ Downloads the Microsoft public key.

sudo gpg --dearmor -o /usr/share/keyrings/microsoft.gpg â†’ Converts the key into a format usable by APT and saves it securely in the /usr/share/keyrings/ directory.This ensures the key is stored in the correct location and can be used for verification.

# Step 2: Update the Microsoft Repository List

Next, we need to make sure the repository is correctly configured. Run:echo "deb [signed-by=/usr/share/keyrings/microsoft.gpg] https://packages.microsoft.com/repos/code stable main" | sudo tee /etc/apt/sources.list.d/vscode.list

## What This Command Does:



deb [signed-by=/usr/share/keyrings/microsoft.gpg] ... â†’ Specifies that APT should use the newly added key to verify the Microsoft repository.

sudo tee /etc/apt/sources.list.d/vscode.list â†’ Ensures the repository information is saved in the correct location.This ensures APT knows where to find VS Code and that it should use the correct key for verification.

# Step 3: Update and Upgrade Packages

Now, update the package lists and upgrade the system to apply the changes:sudo apt update && sudo apt upgrade -y

## Expected Output (No More Errors!)

Now, sudo apt update should complete without any GPG errors, and VS Code updates should install normally.

# Alternative Fix (If the Above Doesnâ€™t Work)

If the issue persists, try these additional steps:

# 1. Remove the Old Repository and Key

sudo rm /etc/apt/sources.list.d/vscode.list

sudo rm /usr/share/keyrings/microsoft.gpgThis removes any old or incorrect repository settings.

# 2. Reinstall the Key and Repository

wget -qO - https://packages.microsoft.com/keys/microsoft.asc | sudo gpg --dearmor -o /usr/share/keyrings/microsoft.gpg

echo "deb [signed-by=/usr/share/keyrings/microsoft.gpg] https://packages.microsoft.com/repos/code stable main" | sudo tee /etc/apt/sources.list.d/vscode.list

# 3. Update Again

sudo apt updateNow, the error should be resolved! ðŸŽ‰

# Why This Fix Works

Ubuntu no longer allows GPG keys to be stored in /etc/apt/trusted.gpg for security reasons. Instead, keys must be stored in /usr/share/keyrings/ and explicitly referenced in the repository list (/etc/apt/sources.list.d/).By following this method, we ensure: The Microsoft GPG key is stored securely. The repository list is properly configured to use the key. Ubuntu can verify VS Code updates without errors.

# Conclusion

If youâ€™re getting a GPG key error when updating Ubuntu after installing VS Code, itâ€™s due to a missing or outdated Microsoft GPG key. You can fix this by:

Downloading and installing the correct key (microsoft.asc).

Updating the repository list to reference the correct key.

Running sudo apt update again to verify everything works.

# FAQs

Q: Is this fix safe?

 A: Yes! This method follows best practices and ensures package security by using GPG verification.Q: Will VS Code stop working if I donâ€™t fix this error?

 A: No, VS Code will still work fine, but you wonâ€™t get automatic updates for new features and security patches.Q: Do I need to repeat these steps in the future?

 A: Only if Microsoft changes its GPG key again. If that happens, just repeat the steps to update the key.~ By Pramitha Jayasooriya

# Contact Details

For further information or to discuss potential opportunities, please feel free to connect with me on my professional and social platforms:

LinkedIn: Pramitha-Jayasooriya

Stackoverflow: https://stackoverflow.com/users/21953303/pramitha-jayasooriya

GitHub: PramithaMJ

Personal Website: PramithaMJ.live

Email : lpramithamj@gmail.comLooking forward to connecting with you!Gpg ErrorNo PubkeyVscodeUbuntu----1

## Written by Pramitha Jayasooriya

36 followersÂ·47 followingAspiring Computer Engineer with a specialized focus on backend technologies. BSc. Eng . (Hons.) Degree in Computer Engineering (UG).

## Responses (1)

See all responsesHelpStatusAboutCareersPressBlogPrivacyRulesTermsText to speech 